import pytest
from src.basemodels.nlp_models.base import BaseNLPPrediction
from src.ml_models.nlp_models.pylanguagetool import PyLanguageToolModel


@pytest.fixture
def speller_model():
    return PyLanguageToolModel()


@pytest.fixture
def text():
    return "превет как дила"


@pytest.fixture
def expected_corrected_text():
    return "Привет как дело"


@pytest.fixture
def expected_corrections():
    return [
        BaseNLPPrediction(
            index=0,
            error="превет",
            suggestions=[
                "Привет",
                "Привить",
                "Приветь",
                "Привит",
                "Принять",
                "Прибить",
                "Пришить",
                "Править",
                "Кривить",
                "Претить",
                "Прилить",
                "Примять",
                "Прилет",
                "Привес",
                "Криветь",
                "Кривит",
                "Кривят",
                "Поревет",
                "Праветь",
                "Правит",
                "Правят",
                "Преет",
                "Пренит",
                "Прервет",
                "Претит",
                "Претят",
                "Прибит",
                "Придёт",
                "Придет",
                "Прилёт",
                "Прилит",
                "Примет",
                "Приметь",
                "Примят",
                "Принят",
                "Припять",
                "Прижит",
                "Прижить",
                "Привёл",
                "Привёз",
                "Приват",
                "Привей",
                "Привел",
                "Привета",
                "Привете",
                "Привету",
                "Приветы",
                "Привез",
                "Привил",
                "Привита",
                "Привито",
                "Привитью",
                "Привитье",
                "Привитьи",
                "Привитья",
                "Привиты",
                "Привив",
                "Привял",
                "Приврет",
                "Привьет",
                "Пришит",
                "Причет",
                "Прядёт",
                "Прядет",
                "Прямит",
                "Прямить",
                "Прямят",
                "Прянет",
                "Прячет",
                "Ревет",
                "П ревет",
                "Пре вет",
            ],
            message="Возможно найдена орфографическая ошибка.",
        ),
        BaseNLPPrediction(
            index=11,
            error="дила",
            suggestions=[
                "дело",
                "дела",
                "делу",
                "сила",
                "тело",
                "село",
                "дима",
                "пила",
                "депо",
                "дева",
                "дико",
                "жила",
                "дуло",
                "гелла",
                "вилла",
                "шило",
                "дина",
                "диво",
                "кило",
                "мило",
                "чело",
                "белла",
                "мила",
                "дека",
                "делон",
                "дюла",
                "диао",
                "дива",
                "долу",
                "дилле",
                "удила",
                "адила",
                "аила",
                "аилу",
                "бела",
                "беллу",
                "бело",
                "белу",
                "била",
                "билла",
                "биллу",
                "било",
                "цела",
                "целла",
                "целлу",
                "цело",
                "дала",
                "дало",
                "деда",
                "деду",
                "дега",
                "дегу",
                "деку",
                "дел",
                "делю",
                "делаю",
                "делах",
                "делай",
                "делал",
                "делам",
                "делан",
                "делая",
                "делав",
                "деле",
                "дели",
                "делом",
                "делор",
                "деля",
                "дель",
                "дема",
                "демо",
                "дему",
                "дена",
                "дену",
                "дера",
                "деру",
                "дета",
                "дето",
                "дежа",
                "дежу",
                "деву",
                "дика",
                "дику",
                "дилю",
                "дилан",
                "дилар",
                "диле",
                "дили",
                "дилон",
                "дилор",
                "диля",
                "диль",
                "диму",
                "дину",
                "диола",
                "дира",
                "диру",
                "диву",
                "длила",
                "доила",
                "дола",
                "дула",
                "дулу",
                "дэлла",
                "дэллу",
                "фила",
                "филу",
                "геллу",
                "хила",
                "хило",
                "ила",
                "йелла",
                "йеллу",
                "кила",
                "килу",
                "лела",
                "лелу",
                "лила",
                "лилла",
                "лиллу",
                "лило",
                "лилу",
                "мела",
                "мело",
                "мелу",
                "милу",
                "нела",
                "нелла",
                "неллу",
                "нелу",
                "нила",
                "нилла",
                "ниллу",
                "нилу",
                "пела",
                "пело",
                "пило",
                "пилу",
                "рила",
                "рилу",
                "села",
                "селу",
                "сило",
                "силу",
                "тела",
                "телу",
                "уела",
                "уело",
                "жило",
                "жилу",
                "вела",
                "велла",
                "велло",
                "веллу",
                "вело",
                "вила",
                "виллу",
                "вило",
                "зело",
                "зила",
                "зилу",
                "шелла",
                "шеллу",
                "шила",
                "шилу",
                "эдила",
                "чела",
                "челу",
                "Адила",
                "Аила",
                "Аилу",
                "Бела",
                "Белла",
                "Беллу",
                "Белу",
                "Билла",
                "Биллу",
                "Фила",
                "Филу",
                "Гелла",
                "Гелло",
                "Геллу",
                "Лела",
                "Лелу",
                "Лила",
                "Лилла",
                "Лиллу",
                "Лилу",
                "Мила",
                "Мило",
                "Милу",
                "Нела",
                "Нелла",
                "Неллу",
                "Нелу",
                "Нила",
                "Нилла",
                "Ниллу",
                "Нилу",
                "Селло",
                "Тилло",
                "Велла",
                "Велло",
                "Веллу",
                "Вилла",
                "Виллу",
                "д ила",
            ],
            message="Возможно найдена орфографическая ошибка.",
        ),
    ]


def test_predict(speller_model, text, expected_corrected_text):
    response = speller_model.predict(text)
    assert response == expected_corrected_text


def test_predict_verbose(
    speller_model, text, expected_corrected_text, expected_corrections
):
    response = speller_model.predict_verbose(text)
    print(response)
    assert response.text == expected_corrected_text
    assert response.corrections == expected_corrections
